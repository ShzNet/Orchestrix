# Orchestrix - Implementation TODO

> High-level overview of implementation phases.
> See `tasks/` folder for detailed implementation of each phase.

---

## Overview

| Phase | Package | Status |
|:------|:--------|:-------|
| 0 | Project Setup | âœ… Done |
| 1 | `Orchestrix.Abstractions` | âœ… Done |
| 2 | `Orchestrix.Transport.*` | ðŸ”² TODO |
| 3 | `Orchestrix.Locking.*` | ðŸ”² TODO |
| 4 | `Orchestrix.Coordinator.*` | ðŸ”² TODO |
| 5 | `Orchestrix.Worker` | ðŸ”² TODO |
| 6 | `Orchestrix.Persistence.*` | ðŸ”² TODO |
| 7 | `Orchestrix.ControlPanel` | ðŸ”² TODO |
| 8 | `Orchestrix.ServiceApi` | ðŸ”² TODO |
| 9 | `Orchestrix.Client` | ðŸ”² TODO |
| 10 | `Orchestrix.Admin` | ðŸ”² TODO |
| 11 | Testing | ðŸ”² TODO |
| 12 | Sample | ðŸ”² TODO |
| 13 | `Orchestrix.Server` | ðŸ”² TODO |

---

## Project Rules

### Namespace Structure

All projects follow a consistent namespace structure:

1. **Empty RootNamespace**: All `.csproj` files must have `<RootNamespace/>` (empty)
2. **Folder-based Namespaces**: Namespaces automatically follow folder structure
3. **Root Folder**: All code files must be inside a root folder matching the project's base namespace

**Example Structure:**

```
src/Orchestrix.Abstractions/
â”œâ”€â”€ Orchestrix.Abstractions.csproj  (with <RootNamespace/>)
â”œâ”€â”€ Orchestrix/                      (root namespace folder)
â”‚   â”œâ”€â”€ Enums/                       â†’ namespace Orchestrix.Enums
â”‚   â”œâ”€â”€ Interfaces/                  â†’ namespace Orchestrix.Interfaces
â”‚   â”œâ”€â”€ DTOs/                        â†’ namespace Orchestrix.DTOs
â”‚   â””â”€â”€ Attributes/                  â†’ namespace Orchestrix.Attributes
â””â”€â”€ Polyfills/                       (exception: System.* namespaces)
```

**Benefits:**
- Easy to extend with new namespaces (just create new folders)
- Namespace matches folder structure automatically
- Consistent across all projects
- No manual namespace configuration needed

### Project Configuration

All projects inherit from `Directory.Build.props`:
- `ImplicitUsings`: enabled
- `Nullable`: enabled
- `LangVersion`: latest
- `TreatWarningsAsErrors`: true
- `GenerateDocumentationFile`: true

### Package Management

- **Central Package Management** (CPM) enabled via `Directory.Packages.props`
- All package versions defined centrally
- Projects reference packages without version numbers

---

## Phase Details

### Phase 0: Project Setup âœ…
- [x] Solution `Orchestrix.slnx`
- [x] `Directory.Build.props`, `Directory.Packages.props`
- [x] Folder structure: `src/`, `docs/`, `tasks/`

### Phase 1: Abstractions âœ…
> ðŸ“„ [`tasks/phase-1-abstractions.md`](./tasks/phase-1-abstractions.md)
- [x] Core enums (JobStatus, JobPriority, LogLevel)
- [x] Job types (JobInfo, IJobContext)
- [x] Schedule types (ScheduleInfo, RetryPolicy)
- [x] Polyfills for netstandard2.1 compatibility

### Phase 2: Transport ðŸ”„
> ðŸ“„ [`tasks/phase-2-transport.md`](./tasks/phase-2-transport.md)
- [x] **2.1 Transport.Abstractions** - 7 channels, 7 messages, no polyfills, DI support
- [ ] 2.2 Transport.Redis - Redis Streams implementation
- [ ] 2.3 Transport.RabbitMQ - RabbitMQ implementation
- [ ] 2.4 Transport.Kafka - Kafka implementation
- [ ] **Unit Tests**: `JsonMessageSerializerTests`

### Phase 3: Locking
> ðŸ“„ [`tasks/phase-3-locking.md`](./tasks/phase-3-locking.md)
- [ ] Locking abstractions
- [ ] InMemory implementation
- [ ] Redis implementation
- [ ] **Unit Tests**: `InMemoryLockTests`, `InMemoryLockProviderTests`

### Phase 4: Coordinator Core
> ðŸ“„ [`tasks/phase-4-coordinator.md`](./tasks/phase-4-coordinator.md)
> ðŸ“„ [`docs/coordinator-implementation-todo.MD`](./docs/coordinator-implementation-todo.MD)
- [ ] **Persistence.Abstractions** (entities + store interfaces)
- [ ] Core services (CoordinatorService)
- [ ] Caching layer
- [ ] Leader Election
- [ ] Scheduling & Dispatching
- [ ] Follower coordination (Ownership)
- [ ] Scale down / handoff (Clustering)
- [ ] Handlers (Enqueue, Heartbeat, Timeout)
- [ ] **Unit Tests**: `LeaderElectionTests`, `JobDispatcherTests`, `JobStateMachineTests`, `SchedulerTests`


### Phase 5: Worker Core
> ðŸ“„ [`tasks/phase-5-worker.md`](./tasks/phase-5-worker.md)
- [ ] Worker service
- [ ] Job execution
- [ ] Handler registry
- [ ] Cancellation handling
- [ ] **Unit Tests**: `JobExecutorTests`, `HandlerRegistryTests`

### Phase 6: Persistence
> ðŸ“„ [`tasks/phase-6-persistence.md`](./tasks/phase-6-persistence.md)
- [ ] InMemory stores
- [ ] EF Core stores
- [ ] Dead Letter Queue (DLQ) store
- [ ] **Unit Tests**: `InMemoryJobStoreTests`, `InMemoryScheduleStoreTests`


### Phase 7: ControlPanel
> ðŸ“„ [`tasks/phase-7-controlpanel.md`](./tasks/phase-7-controlpanel.md)
> **Core business logic library**
- [ ] `IControlPanelService` - Main service interface
- [ ] Enqueue jobs â†’ write to storage
- [ ] Cancel jobs â†’ communicate with Coordinator
- [ ] Query job status, schedules, workers
- [ ] Monitor running jobs (via Coordinator)
- [ ] **Unit Tests**: `ControlPanelServiceTests`

### Phase 8: Service API
> ðŸ“„ [`tasks/phase-8-serviceapi.md`](./tasks/phase-8-serviceapi.md)
> **REST API for 3rd party integration**
- [ ] Uses `IControlPanelService`
- [ ] REST controllers: Jobs, Schedules
- [ ] For external services to enqueue/cancel/query jobs
- [ ] **Unit Tests**: `JobsControllerTests`

### Phase 9: Client SDK
> ðŸ“„ [`tasks/phase-9-client.md`](./tasks/phase-9-client.md)
> **Client library connecting to Service API**
- [ ] `IOrchestrixClient` interface
- [ ] HTTP client to call Phase 8 API
- [ ] EnqueueAsync, CancelAsync, GetStatusAsync
- [ ] **Unit Tests**: `OrchestrixClientTests`

### Phase 10: Admin
> ðŸ“„ [`tasks/phase-10-admin.md`](./tasks/phase-10-admin.md)
> **Admin API + Real-time monitoring dashboard**
- [ ] Uses `IControlPanelService`
- [ ] Admin REST API (full access)
- [ ] SignalR for real-time job/worker status
- [ ] Dashboard integration support
- [ ] **Unit Tests**: `AdminControllerTests`

### Phase 11: Testing
> ðŸ“„ [`tasks/phase-11-testing.md`](./tasks/phase-11-testing.md)
- [ ] Integration tests
- [ ] End-to-end tests

### Phase 12: Sample
> ðŸ“„ [`tasks/phase-12-sample.md`](./tasks/phase-12-sample.md)
- [ ] Sample Coordinator host
- [ ] Sample Worker host
- [ ] Sample API host
- [ ] Sample job handlers

### Phase 13: Server
> ðŸ“„ [`tasks/phase-13-server.md`](./tasks/phase-13-server.md)
> **Pre-packaged all-in-one server application**
- [ ] `Orchestrix.Server` - Coordinator + Service API + Admin API + Dashboard
- [ ] Embedded SPA Dashboard (Blazor/React)
- [ ] Single executable deployment
- [ ] Docker image

---

## Implementation Order

```
Phase 1 â†’ 2 â†’ 3 â†’ 4 â†’ 5 â†’ 6 â†’ 7 â†’ 8 â†’ 9 â†’ 10 â†’ 11 â†’ 12
```

---

## Project Structure

```
Orchestrix/
â”œâ”€â”€ Orchestrix.slnx
â”œâ”€â”€ Directory.Build.props
â”œâ”€â”€ Directory.Packages.props
â”œâ”€â”€ nuget.config
â”œâ”€â”€ idea.md
â”œâ”€â”€ todo.MD
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ architecture-coordinator-cluster.MD
â”‚   â””â”€â”€ coordinator-implementation-todo.MD
â”‚
â”œâ”€â”€ tasks/
â”‚   â”œâ”€â”€ phase-1-abstractions.md
â”‚   â”œâ”€â”€ phase-2-transport.md
â”‚   â”œâ”€â”€ phase-3-locking.md
â”‚   â”œâ”€â”€ phase-4-coordinator.md
â”‚   â”œâ”€â”€ phase-5-worker.md
â”‚   â”œâ”€â”€ phase-6-persistence.md
â”‚   â”œâ”€â”€ phase-7-controlpanel.md
â”‚   â”œâ”€â”€ phase-8-serviceapi.md
â”‚   â”œâ”€â”€ phase-9-client.md
â”‚   â”œâ”€â”€ phase-10-admin.md
â”‚   â”œâ”€â”€ phase-11-testing.md
â”‚   â””â”€â”€ phase-12-sample.md
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ Orchestrix.Abstractions/                    # Phase 1
â”‚   â”‚
â”‚   â”œâ”€â”€ Transport/                                   # Phase 2
â”‚   â”‚   â”œâ”€â”€ Orchestrix.Transport.Abstractions/
â”‚   â”‚   â”œâ”€â”€ Orchestrix.Transport.Redis/
â”‚   â”‚   â”œâ”€â”€ Orchestrix.Transport.RabbitMQ/
â”‚   â”‚   â””â”€â”€ Orchestrix.Transport.Kafka/
â”‚   â”‚
â”‚   â”œâ”€â”€ Locking/                                     # Phase 3
â”‚   â”‚   â”œâ”€â”€ Orchestrix.Locking.Abstractions/
â”‚   â”‚   â”œâ”€â”€ Orchestrix.Locking.InMemory/
â”‚   â”‚   â””â”€â”€ Orchestrix.Locking.Redis/
â”‚   â”‚
â”‚   â”œâ”€â”€ Coordinator/                                 # Phase 4
â”‚   â”‚   â”œâ”€â”€ Orchestrix.Coordinator.Abstractions/
â”‚   â”‚   â”œâ”€â”€ Orchestrix.Coordinator.Persistence.Abstractions/
â”‚   â”‚   â””â”€â”€ Orchestrix.Coordinator/
â”‚   â”‚
â”‚   â”œâ”€â”€ Worker/                                      # Phase 5
â”‚   â”‚   â””â”€â”€ Orchestrix.Worker/
â”‚   â”‚
â”‚   â”œâ”€â”€ Persistence/                                 # Phase 6
â”‚   â”‚   â”œâ”€â”€ Orchestrix.Persistence.InMemory/
â”‚   â”‚   â””â”€â”€ Orchestrix.Persistence.EfCore/
â”‚   â”‚
â”‚   â”œâ”€â”€ ControlPanel/                                # Phase 7
â”‚   â”‚   â””â”€â”€ Orchestrix.ControlPanel/
â”‚   â”‚
â”‚   â”œâ”€â”€ Api/
â”‚   â”‚   â”œâ”€â”€ Orchestrix.ServiceApi/                   # Phase 8
â”‚   â”‚   â””â”€â”€ Orchestrix.Admin/                        # Phase 10
â”‚   â”‚
â”‚   â”œâ”€â”€ Client/                                      # Phase 9
â”‚   â”‚   â””â”€â”€ Orchestrix.Client/
â”‚   â”‚
â”‚   â””â”€â”€ Server/                                      # Phase 13
â”‚       â”œâ”€â”€ Orchestrix.Server/
â”‚       â””â”€â”€ Orchestrix.Dashboard/
â”‚
â”œâ”€â”€ samples/                                         # Phase 12
â”‚   â”œâ”€â”€ Orchestrix.Sample.Jobs/
â”‚   â”œâ”€â”€ Orchestrix.Sample.Coordinator/
â”‚   â”œâ”€â”€ Orchestrix.Sample.Worker/
â”‚   â””â”€â”€ Orchestrix.Sample.Api/
â”‚
â””â”€â”€ tests/                                           # Phase 11
    â”œâ”€â”€ Orchestrix.Tests.Unit/
    â””â”€â”€ Orchestrix.Tests.Integration/
```
```

> **Note**: This shows the high-level project structure only.
> 
> **For detailed file structures**, see individual phase documentation:
> - Phase 1: [`tasks/phase-1-abstractions.md`](./tasks/phase-1-abstractions.md)
> - Phase 2: [`tasks/phase-2-transport.md`](./tasks/phase-2-transport.md)
> - Phase 3: [`tasks/phase-3-locking.md`](./tasks/phase-3-locking.md)
> - And so on...
>
> **Namespace Convention**: All projects follow folder-based namespace structure:
> - Each `.csproj` has `<RootNamespace/>` (empty)
> - Code organized in root folder matching project's base namespace
> - Example: `Orchestrix.Transport.Redis` â†’ `Orchestrix/Transport/Redis/` â†’ `namespace Orchestrix.Transport.Redis;`

